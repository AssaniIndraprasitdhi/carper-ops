@model IEnumerable<Capet_OPS.Models.ReportData>
@{
    Layout = null;
    var first = Model.FirstOrDefault();
}

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>รายงาน Order - @first?.OrderNo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Kanit', sans-serif; font-size: 13px; color: #333; padding: 20px; background: #fff; }
        .print-header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        .print-header h3 { font-weight: 500; }
        .print-header .subtitle { color: #666; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        th, td { border: 1px solid #dee2e6; padding: 6px 10px; text-align: left; font-size: 12px; }
        th { background: #f8f9fa; font-weight: 500; }
        td.num { text-align: right; font-variant-numeric: tabular-nums; }
        td.highlight { font-weight: 500; color: #0d6efd; }
        td.success { font-weight: 500; color: #198754; }
        .btn-print { background: #0d6efd; color: #fff; border: none; padding: 8px 24px; border-radius: 4px; cursor: pointer; font-family: 'Kanit', sans-serif; }
        .no-print { text-align: center; margin-bottom: 15px; }
        .print-footer { margin-top: 20px; padding-top: 10px; border-top: 1px solid #dee2e6; display: flex; justify-content: space-between; font-size: 11px; color: #888; }

        @@media print {
            .no-print { display: none; }
            body { padding: 10px; }
        }
    </style>
</head>
<body>
    <div class="no-print">
        <button class="btn-print" onclick="window.print()">พิมพ์รายงาน</button>
    </div>

    <div class="print-header">
        <h3>รายงานอัตราการเผื่อและอัตราการใช้กาว</h3>
        <div class="subtitle">Order No: @first?.OrderNo</div>
    </div>

    <table>
        <thead>
            <tr>
                <th>#</th>
                <th>HT_BARCODE</th>
                <th>รายการ</th>
                <th>ผืนที่</th>
                <th style="text-align:right;">กว้าง</th>
                <th style="text-align:right;">ยาว</th>
                <th style="text-align:right;">%เผื่อกว้าง</th>
                <th style="text-align:right;">%เผื่อยาว</th>
                <th style="text-align:right;">กว้างเผื่อ</th>
                <th style="text-align:right;">ยาวเผื่อ</th>
                <th style="text-align:right;">ตรม.เผื่อ</th>
                <th>กาว</th>
                <th style="text-align:right;">ใช้กาว(kg)</th>
                <th style="text-align:right;">กาว/ตรม.</th>
            </tr>
        </thead>
        <tbody>
            @{ var idx = 0; }
            @foreach (var item in Model)
            {
                idx++;
                <tr>
                    <td>@idx</td>
                    <td>@item.HT_BARCODE</td>
                    <td class="num">@item.ListNo</td>
                    <td class="num">@item.ItemNo</td>
                    <td class="num">@item.Width.ToString("N4")</td>
                    <td class="num">@item.Length.ToString("N4")</td>
                    <td class="num">@item.AllowanceWidthPct.ToString("N2")%</td>
                    <td class="num">@item.AllowanceLengthPct.ToString("N2")%</td>
                    <td class="num highlight">@item.ActualWidth.ToString("N4")</td>
                    <td class="num highlight">@item.ActualLength.ToString("N4")</td>
                    <td class="num highlight">@item.ActualSqm.ToString("N4")</td>
                    <td>@item.GlueDesc</td>
                    <td class="num">@item.GlueUsage.ToString("N4")</td>
                    <td class="num success">@item.GluePerSqm.ToString("N4")</td>
                </tr>
            }
        </tbody>
    </table>

    <div class="print-footer">
        <div>วันที่พิมพ์: @DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss")</div>
        <div>CMT Production Report System</div>
    </div>
</body>
</html>
